function [Amat,Bmat] = funJac(x,u)% x and u are vector at that time stamp

global XT  r L MI g nx ny lam Q R Qf 

m1 = m(1);
m2 = m(2);

L1 = L(1);
L2 = L(2);
r1 = r(1);
r2 = r(2);
MI1 = MI(1);
MI2 = MI(2);
tht1 = x(1);
tht2 = x(2);
omg1 = x(3);
omg2 = x(4);


Amat = [0,0,1,0;0,0,0,1;(-1).*g.*(m1+m2).*cos(tht1)+(-1).*L2.*m2.* ...
  omg2.^2.*cos(tht1+(-1).*tht2),L2.*m2.*omg2.^2.*cos(tht1+(-1).* ...
  tht2),0,(-2).*L2.*m2.*omg2.*sin(tht1+(-1).*tht2);L1.*m2.*omg1.^2.* ...
  cos(tht1+(-1).*tht2),(-1).*L1.*m2.*omg1.^2.*cos(tht1+(-1).*tht2)+( ...
  -1).*g.*m2.*cos(tht2),2.*L1.*m2.*omg1.*sin(tht1+(-1).*tht2),0];

Bmat = [0,0;0,0;L2.*m2.*(L1.*L2.*m1.*m2+L1.*L2.*m2.^2+(-1).*L1.*L2.* ...
  m2.^2.*cos(tht1+(-1).*tht2).^2).^(-1),(-1).*L2.*m2.*cos(tht1+(-1) ...
  .*tht2).*(L1.*L2.*m1.*m2+L1.*L2.*m2.^2+(-1).*L1.*L2.*m2.^2.*cos( ...
  tht1+(-1).*tht2).^2).^(-1);(-1).*L1.*m2.*cos(tht1+(-1).*tht2).*( ...
  L1.*L2.*m1.*m2+L1.*L2.*m2.^2+(-1).*L1.*L2.*m2.^2.*cos(tht1+(-1).* ...
  tht2).^2).^(-1),L1.*(m1+m2).*(L1.*L2.*m1.*m2+L1.*L2.*m2.^2+(-1).* ...
  L1.*L2.*m2.^2.*cos(tht1+(-1).*tht2).^2).^(-1)];